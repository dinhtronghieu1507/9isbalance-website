<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C√¥ng C·ª• Ph√¢n T√≠ch S·ª©c Kh·ªèe - 9isBalance</title>
    <link rel="icon" type="image/png" href="https://i.postimg.cc/59qtkKWY/AVA-BETA.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #007BFF;
            --secondary-color: #00C6FF;
            --dark-color: #2c3e50;
            --light-color: #ffffff;
            --text-color: #4a4a4a;
            --gray-bg: #f0f4f8;
            --border-radius: 20px;
            --shadow: 0 15px 35px rgba(60, 90, 130, 0.1);
            /* ===== S·ª¨A L·ªñI: B·ªî SUNG L·∫†I C√ÅC BI·∫æN M√ÄU ===== */
            --status-underweight: #3498db;
            --status-normal: #28a745;
            --status-overweight: #f1c40f;
            --status-obese: #e74c3c;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Be Vietnam Pro', sans-serif;
            background-color: var(--gray-bg);
            color: var(--text-color);
            line-height: 1.6;
            padding: 10px;
        }
        .wrapper { max-width: 1200px; margin: 0 auto; }
        
        .main-header { display: flex; justify-content: space-between; align-items: center; padding: 10px 20px 30px 20px; }
        .logo { font-size: 1.8em; font-weight: 800; color: var(--dark-color); text-decoration: none; }
        
        .main-nav { display: flex; align-items: center; }
        .main-nav a, .dropdown-btn { text-decoration: none; color: var(--dark-color); margin-left: 25px; font-weight: 600; padding: 8px 12px; border-radius: 8px; transition: all 0.3s ease; cursor: pointer; }
        .main-nav a:hover, .dropdown-btn:hover { color: var(--primary-color); }
        .main-nav a.active, .dropdown-btn.active { background-image: linear-gradient(45deg, var(--primary-color), var(--secondary-color)); color: var(--light-color); }
        
        .dropdown { position: relative; display: inline-block; }
        .dropdown-content { display: none; position: absolute; background-color: var(--light-color); min-width: 220px; box-shadow: 0 8px 16px 0 rgba(0,0,0,0.1); z-index: 1; border-radius: var(--border-radius); margin-top: 10px; padding: 5px 0; border: 1px solid #eee; }
        .dropdown-content a { color: var(--dark-color); padding: 12px 16px; text-decoration: none; display: block; margin-left: 0; border-radius: 0; font-size: 0.95em; }
        .dropdown-content a:hover { background-color: #f1f1f1; }
        .dropdown:hover .dropdown-content { display: block; }
        
        .card { background: var(--light-color); border-radius: var(--border-radius); box-shadow: var(--shadow); padding: 30px; margin-bottom: 30px; }
        
        .calculator-form h1 { font-size: 1.8em; font-weight: 800; color: var(--dark-color); margin-bottom: 25px; }
        .form-group { margin-bottom: 18px; }
        .form-group label { font-weight: 700; color: var(--dark-color); display: flex; align-items: center; margin-bottom: 10px; }
        .form-group label span { margin-right: 8px; font-size: 1.2em; color: var(--primary-color); }
        
        .input-text, .input-select { width: 100%; padding: 12px 15px; border-radius: 10px; border: 1px solid #dfe6e9; font-family: 'Be Vietnam Pro', sans-serif; font-size: 1em; transition: all 0.3s ease; }
        .input-text:focus, .input-select:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.15); }
        .input-radio-group { display: flex; gap: 20px; }
        
        .btn { padding: 14px 30px; border: none; border-radius: 50px; font-size: 1.1em; font-weight: 700; cursor: pointer; transition: all 0.3s ease; width: 100%; background-image: linear-gradient(45deg, var(--primary-color), var(--secondary-color)); color: var(--light-color); box-shadow: 0 8px 20px rgba(0, 123, 255, 0.3); margin-top: 10px; }
        .btn:hover { transform: translateY(-3px); box-shadow: 0 10px 25px rgba(0, 123, 255, 0.4); }
        .btn:disabled { background-image: none; background-color: #bdc3c7; cursor: not-allowed; box-shadow: none; transform: none; }
        
        .results-dashboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; margin-bottom: 30px;}
        .result-card { background: var(--light-color); border-radius: var(--border-radius); box-shadow: var(--shadow); padding: 25px; animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        .results-dashboard .result-card { display: flex; flex-direction: column; justify-content: center; text-align: center; }
        .result-card h3 { font-size: 1.1em; font-weight: 700; color: var(--dark-color); margin-bottom: 15px; text-align: center; }
        
        #bmi-value { font-size: 4em; font-weight: 800; line-height: 1; }
        #bmi-interpretation { font-weight: 700; font-size: 1.5em; margin-left: 10px; }
        .bmi-progress-bar { height: 10px; background-color: #eef5f9; border-radius: 10px; overflow: hidden; position: relative; }
        #bmi-progress-value { height: 100%; width: 0; border-radius: 10px; transition: width 1.5s ease-out, background-color 0.5s ease; }
        
        .calories-card { background: rgba(44, 62, 80, 0.8); backdrop-filter: blur(10px); color: var(--light-color); justify-content: space-around; }
        .tdee-main, .bmr-secondary { text-align: center; flex: 1; display: flex; flex-direction: column; justify-content: center; }
        .tdee-main { padding-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .bmr-secondary { padding-top: 15px; }
        .calories-card .icon { font-size: 2.2em; line-height: 1; margin-bottom: 8px; opacity: 0.9; }
        .tdee-main .value { font-size: 3.5em; font-weight: 800; color: var(--light-color); line-height: 1.1; }
        .bmr-secondary .value { font-size: 2.2em; font-weight: 700; }

        .range-display { display: flex; justify-content: center; align-items: baseline; gap: 15px; margin-top: 10px; }
        .weight-value span { font-size: 2.5em; font-weight: 800; color: var(--primary-color); }
        .weight-value small { font-size: 1.2em; font-weight: 700; color: var(--dark-color); margin-left: 5px; }
        .range-separator { font-size: 2em; font-weight: 600; color: var(--text-color); }
        #weight-range-card p { text-align: center; margin-bottom: 5px;}

        .detail-item { margin-bottom: 25px; }
        .detail-item p, .detail-item ul { font-size: 0.95em; opacity: 0.9; line-height: 1.7; }
        .detail-item ul { list-style-position: inside; padding-left: 10px;}
        .detail-item-title { font-size: 1.1em; font-weight: 700; margin-bottom: 8px; display: flex; align-items: center; }
        .detail-item-title span { margin-right: 12px; font-size: 1.2em; }
        
        .macros-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .macro-card { border: 1px solid #f0f4f8; border-radius: var(--border-radius); padding: 20px; text-align: center; background-color: #f8f9fa; }
        .macro-card h4 { font-size: 1.2em; margin-bottom: 10px; }
        .macro-calories { font-size: 2.5em; font-weight: 800; color: var(--primary-color); line-height: 1.1; }
        .macro-calories span { font-size: 0.5em; font-weight: 600; color: var(--text-color); }
        .macro-details-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-top: 20px; border-top: 1px solid #eef5f9; padding-top: 15px; }
        .macro-detail-item { font-size: 0.9em; }
        .macro-detail-item strong { display: block; font-size: 1.4em; color: var(--dark-color); }
        
        .accordion-item { border-bottom: 1px solid #f0f4f8; }
        .accordion-item:last-child { border-bottom: none; }
        .accordion-header { background: none; border: none; width: 100%; text-align: left; padding: 18px 5px; font-size: 1.1em; font-weight: 700; color: var(--dark-color); cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
        .accordion-header:hover { background-color: #f8f9fa; }
        .accordion-header .zone-title { display: flex; align-items: center; }
        .accordion-icon { font-size: 1.4em; font-weight: 600; transition: transform 0.3s ease; }
        .accordion-header.active .accordion-icon { transform: rotate(45deg); }
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.4s ease-out; padding: 0 15px; font-size: 0.95em; }
        .accordion-content .content-inner { padding-bottom: 20px; }
        .accordion-content p, .accordion-content ul { margin-bottom: 15px; }
        .accordion-content ul { padding-left: 20px; }
        .accordion-content strong { color: var(--dark-color); }
        .zone-color { display: inline-block; width: 14px; height: 14px; border-radius: 50%; margin-right: 12px; }
        
        .unified-cta-card { background-image: linear-gradient(45deg, var(--primary-color), var(--secondary-color)); color: var(--light-color); text-align: center; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .unified-cta-card h2 { font-size: 1.8em; font-weight: 800; margin-bottom: 20px; max-width: 90%; }
        .cta-btn { text-decoration: none; color: var(--primary-color); background: var(--light-color); padding: 12px 30px; border-radius: 50px; font-weight: 700; transition: all 0.3s ease; display: inline-block; width: auto; }
        .cta-btn:hover { transform: scale(1.05) translateY(-2px); box-shadow: 0 8px 20px rgba(0,0,0,0.15); }
        #share-link { margin-top: 25px; font-size: 0.95em; color: var(--light-color); opacity: 0.8; text-decoration: underline; cursor: pointer; transition: opacity 0.3s; }
        #share-link:hover { opacity: 1; }
        
        .modal-overlay { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6); animation: fadeIn 0.3s; }
        .modal-content { background-color: #fff; margin: 10% auto; padding: 25px; border-radius: var(--border-radius); width: 90%; max-width: 400px; text-align: center; position: relative; box-shadow: 0 10px 30px rgba(0,0,0,0.2); animation: slideIn 0.4s ease-out; }
        @keyframes slideIn { from {transform: translateY(-50px); opacity: 0;} to {transform: translateY(0); opacity: 1;} }
        .modal-content img { max-width: 100%; height: auto; border-radius: 10px; }
        .close-button { color: #aaa; position: absolute; top: 15px; right: 20px; font-size: 28px; font-weight: bold; transition: color 0.3s; }
        .close-button:hover, .close-button:focus { color: #333; text-decoration: none; cursor: pointer; }
        
        @media (max-width: 900px) {
            .app-grid, .results-dashboard { grid-template-columns: 1fr; }
            .main-header { flex-direction: column; gap: 15px; }
            .main-nav { flex-direction: column; width: 100%; gap: 10px; }
            .main-nav a, .dropdown { margin-left: 0; width: 100%; text-align: center; }
            .main-nav a.active { background-color: var(--primary-color); }
            .dropdown-content { display: none; position: static; box-shadow: none; border: none; background-color: var(--gray-bg); width: 100%; padding-top: 10px; }
            .dropdown:hover .dropdown-content, .dropdown-btn:focus + .dropdown-content { display: flex; flex-direction: column; gap: 5px; }
            .dropdown-content a { background-color: var(--light-color); border-radius: 8px; }
            .card { padding: 20px; }
            .calculator-form h1 { font-size: 1.6em; }
        }
    </style>
</head>
<body>
    <div class="wrapper">
        <header class="main-header">
            <a href="index.html" class="logo">9isBalance</a>
            <nav class="main-nav">
                <div class="dropdown">
                    <span class="dropdown-btn">D·ªãch v·ª• ‚ñº</span>
                    <div class="dropdown-content">
                        <a href="index.html">HL C√° nh√¢n</a>
                        <a href="huan-luyen-nang-cao.html">HL N√¢ng cao</a>
                        <a href="tri-lieu-phuc-hoi.html">Tr·ªã li·ªáu & Ph·ª•c h·ªìi</a>
                        <a href="tu-van-online.html">T∆∞ v·∫•n Online</a>
                    </div>
                </div>
                <a href="cong-cu-tinh-toan.html" class="active">C√¥ng c·ª• S·ª©c kh·ªèe</a>
                <a href="gioi-thieu.html">V·ªÅ t√¥i</a>
                <a href="dang-ky.html">ƒêƒÉng k√Ω</a>
            </nav>
        </header>

        <div id="main-content">
            <div class="card calculator-form" id="analysis-form">
                <h1>Ph√¢n T√≠ch S·ª©c Kh·ªèe To√†n Di·ªán</h1>
                <div class="form-group"><label for="gender"><span>üë§</span>Gi·ªõi t√≠nh</label><div class="input-radio-group"><label><input type="radio" name="gender" value="male" checked> Nam</label><label><input type="radio" name="gender" value="female"> N·ªØ</label></div></div>
                <div class="form-group"><label for="age"><span>üéÇ</span>Tu·ªïi</label><input type="number" id="age" class="input-text" placeholder="Nh·∫≠p tu·ªïi c·ªßa b·∫°n" min="15" max="100"></div>
                <div class="form-group"><label for="height"><span>üìè</span>Chi·ªÅu cao (cm)</label><input type="number" id="height" class="input-text" placeholder="V√≠ d·ª•: 175" min="100" max="220"></div>
                <div class="form-group"><label for="weight"><span>‚öñÔ∏è</span>C√¢n n·∫∑ng (kg)</label><input type="number" id="weight" class="input-text" placeholder="V√≠ d·ª•: 68.5" min="30" max="180"></div>
                <div class="form-group"><label for="bodyfat"><span>üî•</span>T·ª∑ l·ªá m·ª° (%) (T√πy ch·ªçn)</label><input type="number" id="bodyfat" class="input-text" placeholder="ƒê·ªÉ tr·ªëng n·∫øu kh√¥ng bi·∫øt" min="3" max="50"></div>
                <div class="form-group">
                    <label for="activity"><span>üèÉ</span>M·ª©c ƒë·ªô v·∫≠n ƒë·ªông</label>
                    <select id="activity" class="input-select">
                        <option value="1.2">√çt v·∫≠n ƒë·ªông (l√†m vi·ªác vƒÉn ph√≤ng)</option>
                        <option value="1.375" selected>V·∫≠n ƒë·ªông nh·∫π (t·∫≠p 1-3 ng√†y/tu·∫ßn)</option>
                        <option value="1.55">V·∫≠n ƒë·ªông v·ª´a (t·∫≠p 3-5 ng√†y/tu·∫ßn)</option>
                        <option value="1.725">V·∫≠n ƒë·ªông nhi·ªÅu (t·∫≠p 6-7 ng√†y/tu·∫ßn)</option>
                        <option value="1.9">V·∫≠n ƒë·ªông r·∫•t nhi·ªÅu (c∆∞·ªùng ƒë·ªô cao & c√¥ng vi·ªác th·ªÉ ch·∫•t)</option>
                    </select>
                </div>
                <hr style="border: 0; border-top: 1px solid #f0f4f8; margin: 25px 0;">
                <h3 style="font-size: 1.3em; font-weight: 700; color: var(--dark-color); margin-bottom: 15px;">Ph√¢n t√≠ch Nh·ªãp tim (T√πy ch·ªçn)</h3>
                <div class="form-group"><label for="hr-resting"><span>‚ù§Ô∏è</span>Nh·ªãp tim l√∫c ngh·ªâ (bpm)</label><input type="number" id="hr-resting" class="input-text" placeholder="ƒêo v√†o bu·ªïi s√°ng sau khi th·ª©c d·∫≠y ƒë·ªÉ c√≥ k·∫øt qu·∫£ t·ªët nh·∫•t" min="30" max="120"></div>
                <button id="calculate-btn" class="btn">Ph√¢n T√≠ch To√†n Di·ªán</button>
            </div>
        </div>

        <div id="results-area" style="display: none; margin-top: 30px;">
            <div class="results-dashboard">
                <div class="result-card">
                    <h3>Ch·ªâ s·ªë BMI</h3>
                    <div class="bmi-main-result"> <span id="bmi-value">--</span> <span id="bmi-interpretation"></span> </div>
                    <div class="bmi-progress-bar"> <div id="bmi-progress-value"></div> </div>
                    <p class="bmi-summary" id="bmi-summary-text"></p>
                </div>
                <div class="result-card calories-card">
                    <div class="tdee-main"><div class="icon">üî•</div><div class="value" id="tdee-value">--</div><div class="label">TDEE</div></div>
                    <div class="bmr-secondary"><div class="icon">‚ù§Ô∏è</div><div class="value" id="bmr-value">--</div><div class="label">BMR</div></div>
                </div>
                <div class="result-card" id="weight-range-card">
                    <h3>Kho·∫£ng C√¢n N·∫∑ng L√Ω T∆∞·ªüng</h3>
                    <p>D·ª±a tr√™n chi·ªÅu cao c·ªßa b·∫°n:</p>
                    <div class="range-display">
                        <div class="weight-value"><span id="min-weight">--</span><small>kg</small></div>
                        <div class="range-separator">-</div>
                        <div class="weight-value"><span id="max-weight">--</span><small>kg</small></div>
                    </div>
                </div>
            </div>
            
            <div class="card result-card" id="hr-analysis-card" style="display: none;">
                <h1 style="text-align: center;">Ph√¢n T√≠ch Chuy√™n S√¢u V√πng Nh·ªãp Tim</h1>
                <p style="text-align: center; max-width: 800px; margin: 0 auto 25px;">Ch√†o b·∫°n, v·ªõi h∆°n 30 nƒÉm nghi√™n c·ª©u v√† ·ª©ng d·ª•ng nh·ªãp tim trong hu·∫•n luy·ªán, t√¥i r·∫•t s·∫µn l√≤ng chia s·∫ª nh·ªØng ph√¢n t√≠ch chuy√™n s√¢u v·ªÅ c√°c v√πng nh·ªãp tim. ƒê√¢y l√† ch√¨a kh√≥a ƒë·ªÉ t·∫≠p luy·ªán th√¥ng minh, t·ªëi ∆∞u h√≥a hi·ªáu su·∫•t v√† ph√≤ng tr√°nh ch·∫•n th∆∞∆°ng.</p>
                <div id="hr-accordion-container"></div>
            </div>

            <div class="card result-card" style="margin-bottom: 30px;">
                <h1>Ph√¢n T√≠ch & L·ªùi khuy√™n BMI</h1>
                <div class="detail-item"> <h4 class="detail-item-title"><span>üö®</span>M·ª©c ƒë·ªô c·∫£nh b√°o</h4> <p id="bmi-warning"></p> </div>
                <div class="detail-item"> <h4 class="detail-item-title"><span>üí™</span>L·ªùi khuy√™n h√†nh ƒë·ªông</h4> <div id="bmi-action"></div> </div>
                <div class="detail-item" style="margin-bottom: 0;"> <h4 class="detail-item-title"><span>ü•ó</span>Khuy·∫øn ngh·ªã chung</h4> <p id="bmi-recommendation"></p> </div>
            </div>
            
             <div class="card result-card" style="margin-bottom: 30px;">
                 <h3>B·∫£ng Macros G·ª£i √Ω</h3>
                 <div class="macros-grid" id="macros-results-container"></div>
             </div>
             
             <div class="card result-card unified-cta-card" style="margin-bottom: 30px;">
                 <h2 id="cta-text"></h2>
                 <a href="dang-ky.html" id="cta-link" class="cta-btn"></a>
                 <div id="share-link" style="margin-top: 25px;">üîó Chia s·∫ª c√¥ng c·ª• n√†y v·ªõi b·∫°n b√®</div>
             </div>
        </div>

        <div style="background: linear-gradient(45deg, #eef5f9, #d9e8f6); margin-top: 30px; text-align: center; padding: 40px 25px; border-radius: var(--border-radius);">
            <h3 style="font-size: 1.6em; color: var(--dark-color); margin-bottom: 15px;">Th·∫•y c√¥ng c·ª• n√†y h·ªØu √≠ch?</h3>
            <p style="max-width: 600px; margin: 0 auto 25px; font-size: 1.05em; line-height: 1.7; opacity: 0.85;">S·ª± ·ªßng h·ªô c·ªßa b·∫°n, d√π l√† nh·ªè nh·∫•t, c≈©ng l√† ƒë·ªông l·ª±c l·ªõn gi√∫p t√¥i duy tr√¨ v√† ph√°t tri·ªÉn th√™m nhi·ªÅu c√¥ng c·ª• mi·ªÖn ph√≠ kh√°c cho c·ªông ƒë·ªìng.</p>
            <button id="donate-button" class="btn" style="display: inline-block; width: auto; text-decoration: none; padding: 12px 30px;">M·ªùi t√¥i m·ªôt ly c√† ph√™ ‚òï</button>
        </div>
        
        <p style="text-align: center; margin-top: 20px; font-size: 0.9em; color: #7f8c8d;">L∆∞u √Ω: C√°c k·∫øt qu·∫£ t√≠nh to√°n ch·ªâ mang t√≠nh ch·∫•t tham kh·∫£o. H√£y li√™n h·ªá chuy√™n gia ƒë·ªÉ c√≥ l·ªùi khuy√™n ch√≠nh x√°c nh·∫•t.</p>
    </div>

    <div id="qr-modal" class="modal-overlay">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h4 style="margin-bottom: 15px; font-size: 1.2em;">Qu√©t m√£ ƒë·ªÉ ·ªßng h·ªô</h4>
            <img src="https://i.postimg.cc/JhBny201/qr-code.png" alt="M√£ QR ·ªßng h·ªô">
        </div>
    </div>
    
    <script>
        const calculateBtn = document.getElementById('calculate-btn');
        const resultsArea = document.getElementById('results-area');
        
        function animateValue(element, start, end, duration) { let startTimestamp = null; const step = (timestamp) => { if (!startTimestamp) startTimestamp = timestamp; const progress = Math.min((timestamp - startTimestamp) / duration, 1); element.textContent = Math.floor(progress * (end - start) + start).toLocaleString('vi-VN'); if (progress < 1) { window.requestAnimationFrame(step); } }; window.requestAnimationFrame(step); }
        function animateDecimal(element, start, end, duration) { let startTimestamp = null; const step = (timestamp) => { if (!startTimestamp) startTimestamp = timestamp; const progress = Math.min((timestamp - startTimestamp) / duration, 1); element.textContent = (progress * (end - start) + start).toFixed(1); if (progress < 1) { window.requestAnimationFrame(step); } }; window.requestAnimationFrame(step); }
        function getBmiStatus(bmi) { if (bmi < 18.5) { return { text: 'Thi·∫øu c√¢n', className: 'status-underweight', summary: 'C∆° th·ªÉ b·∫°n ƒëang kh√¥ng c√≥ ƒë·ªß nƒÉng l∆∞·ª£ng v√† d∆∞·ª°ng ch·∫•t.', warning: 'CAO ƒê·∫æN B√ÅO ƒê·ªòNG ƒê·ªé. ƒê√¢y kh√¥ng ph·∫£i l√† m·ªôt v√≥c d√°ng "m·∫£nh mai" ƒë√°ng ao ∆∞·ªõc m√† l√† m·ªôt t√¨nh tr·∫°ng s·ª©c kh·ªèe ƒë√°ng b√°o ƒë·ªông. C∆° th·ªÉ b·∫°n ƒëang kh√¥ng c√≥ ƒë·ªß nƒÉng l∆∞·ª£ng v√† d∆∞·ª°ng ch·∫•t ƒë·ªÉ duy tr√¨ c√°c ch·ª©c nƒÉng s·ªëng c∆° b·∫£n m·ªôt c√°ch t·ªëi ∆∞u. ƒê·∫∑c bi·ªát v·ªõi BMI d∆∞·ªõi 17 (G·∫ßy ƒë·ªô II, III): ƒê√¢y l√† m·ª©c B√ÅO ƒê·ªòNG ƒê·ªé. Nguy c∆° suy gi·∫£m h·ªá mi·ªÖn d·ªãch, lo√£ng x∆∞∆°ng, r·ª•ng t√≥c, m·∫•t c∆°, r·ªëi lo·∫°n n·ªôi ti·∫øt (·ªü ph·ª• n·ªØ c√≥ th·ªÉ g√¢y m·∫•t kinh), v√† suy nh∆∞·ª£c to√†n th√¢n l√† r·∫•t cao.', action: `<ul><li><strong>G·∫∑p chuy√™n gia y t·∫ø NGAY L·∫¨P T·ª®C:</strong> B∆∞·ªõc ƒë·∫ßu ti√™n v√† quan tr·ªçng nh·∫•t l√† ph·∫£i ƒëi kh√°m b√°c sƒ© ƒë·ªÉ lo·∫°i tr·ª´ c√°c nguy√™n nh√¢n b·ªánh l√Ω ti·ªÅm ·∫©n g√¢y s·ª•t c√¢n ho·∫∑c kh√≥ tƒÉng c√¢n (v√≠ d·ª•: b·ªánh v·ªÅ tuy·∫øn gi√°p, r·ªëi lo·∫°n ti√™u h√≥a, nhi·ªÖm k√Ω sinh tr√πng...).</li><li><strong>TƒÉng c∆∞·ªùng dinh d∆∞·ª°ng CH·∫§T L∆Ø·ª¢NG:</strong> M·ª•c ti√™u kh√¥ng ph·∫£i l√† ƒÉn th·∫≠t nhi·ªÅu ƒë·ªì ng·ªçt hay ch·∫•t b√©o b√£o h√≤a. H√£y t·∫≠p trung tƒÉng l∆∞·ª£ng calo t·ª´ c√°c ngu·ªìn th·ª±c ph·∫©m l√†nh m·∫°nh:<ul><li><strong>Protein:</strong> TƒÉng c∆∞·ªùng th·ªãt n·∫°c, c√°, tr·ª©ng, s·ªØa, c√°c lo·∫°i ƒë·∫≠u, h·∫°t ƒë·ªÉ x√¢y d·ª±ng l·∫°i kh·ªëi c∆° b·∫Øp ƒë√£ m·∫•t.</li><li><strong>Ch·∫•t b√©o t·ªët:</strong> B·ªï sung qu·∫£ b∆°, d·∫ßu √¥ liu, c√°c lo·∫°i h·∫°t (√≥c ch√≥, h·∫°nh nh√¢n), c√° b√©o (c√° h·ªìi, c√° tr√≠ch).</li><li><strong>Carbohydrate ph·ª©c h·ª£p:</strong> Ch·ªçn ng≈© c·ªëc nguy√™n h·∫°t, y·∫øn m·∫°ch, khoai lang, g·∫°o l·ª©t ƒë·ªÉ cung c·∫•p nƒÉng l∆∞·ª£ng b·ªÅn b·ªâ.</li></ul></li><li><strong>Chia nh·ªè b·ªØa ƒÉn:</strong> ƒÇn 5-6 b·ªØa nh·ªè trong ng√†y thay v√¨ 3 b·ªØa l·ªõn. ƒêi·ªÅu n√†y gi√∫p b·∫°n kh√¥ng c·∫£m th·∫•y qu√° no v√† c∆° th·ªÉ d·ªÖ h·∫•p thu dinh d∆∞·ª°ng h∆°n. B·ªï sung c√°c b·ªØa ph·ª• b·∫±ng s·ªØa chua, sinh t·ªë, c√°c lo·∫°i h·∫°t.</li><li><strong>T·∫≠p luy·ªán ƒë·ªÉ x√¢y d·ª±ng c∆° b·∫Øp:</strong> ƒê·ª´ng ch·ªâ t·∫≠p c√°c b√†i cardio. H√£y k·∫øt h·ª£p c√°c b√†i t·∫≠p kh√°ng l·ª±c (n√¢ng t·∫°, gym) d∆∞·ªõi s·ª± h∆∞·ªõng d·∫´n c·ªßa hu·∫•n luy·ªán vi√™n ƒë·ªÉ ƒë·∫£m b·∫£o c√¢n n·∫∑ng tƒÉng l√™n l√† c∆° b·∫Øp, kh√¥ng ph·∫£i m·ª°.</li></ul>`, recommendation: 'TƒÉng c√¢n l√†nh m·∫°nh l√† m·ªôt qu√° tr√¨nh ƒë√≤i h·ªèi s·ª± ki√™n nh·∫´n, ƒë√¥i khi c√≤n kh√≥ h∆°n gi·∫£m c√¢n. H√£y ƒë·∫∑t m·ª•c ti√™u tƒÉng t·ª´ 0.2 - 0.5 kg m·ªói tu·∫ßn. Theo d√µi ti·∫øn tr√¨nh, l·∫Øng nghe c∆° th·ªÉ v√† ƒë·ª´ng ng·∫ßn ng·∫°i t√¨m ki·∫øm s·ª± gi√∫p ƒë·ª° t·ª´ chuy√™n gia dinh d∆∞·ª°ng.', ctaText: 'C·∫ßn m·ªôt l·ªô tr√¨nh tƒÉng c√¢n an to√†n v√† hi·ªáu qu·∫£?', ctaButton: 'T∆∞ v·∫•n ngay', ctaLinkHref: 'dang-ky.html?service=hl-ca-nhan' }; } else if (bmi >= 18.5 && bmi < 24.9) { return { text: 'B√¨nh th∆∞·ªùng', className: 'status-normal', summary: 'Ch√∫c m·ª´ng! B·∫°n ƒëang ·ªü m·ª©c c√¢n n·∫∑ng l√Ω t∆∞·ªüng.', warning: 'AN TO√ÄN - L√ù T∆Ø·ªûNG. Xin ch√∫c m·ª´ng! B·∫°n ƒëang ·ªü trong ng∆∞·ª°ng c√¢n n·∫∑ng kh·ªèe m·∫°nh, gi√∫p gi·∫£m thi·ªÉu nguy c∆° m·∫Øc c√°c b·ªánh m√£n t√≠nh li√™n quan ƒë·∫øn c√¢n n·∫∑ng. ƒê√¢y l√† m·ªôt th√†nh t·ª±u ƒë√°ng t·ª± h√†o.', action: `<ul><li><strong>Duy tr√¨ v√† Ph√°t huy:</strong> M·ª•c ti√™u ch√≠nh c·ªßa b·∫°n b√¢y gi·ªù l√† duy tr√¨ l·ªëi s·ªëng t√≠ch c·ª±c n√†y. ƒê·ª´ng xem ƒë√¢y l√† l√Ω do ƒë·ªÉ ch·ªß quan.</li><li><strong>ƒÇn u·ªëng c√¢n b·∫±ng:</strong> Ti·∫øp t·ª•c duy tr√¨ m·ªôt ch·∫ø ƒë·ªô ƒÉn ƒëa d·∫°ng, gi√†u rau xanh, tr√°i c√¢y, protein n·∫°c v√† ng≈© c·ªëc nguy√™n h·∫°t. H√£y ch√∫ √Ω ƒë·∫øn vi·ªác ki·ªÉm so√°t l∆∞·ª£ng ƒë∆∞·ªùng, mu·ªëi v√† th·ª±c ph·∫©m ch·∫ø bi·∫øn s·∫µn.</li><li><strong>V·∫≠n ƒë·ªông ƒë·ªÅu ƒë·∫∑n:</strong> Duy tr√¨ √≠t nh·∫•t 150 ph√∫t ho·∫°t ƒë·ªông th·ªÉ ch·∫•t c∆∞·ªùng ƒë·ªô v·ª´a ph·∫£i m·ªói tu·∫ßn (nh∆∞ ƒëi b·ªô nhanh, ƒë·∫°p xe, b∆°i l·ªôi).</li></ul>`, recommendation: 'Ch·ªâ s·ªë BMI b√¨nh th∆∞·ªùng kh√¥ng c√≥ nghƒ©a l√† b·∫°n ho√†n to√†n kh·ªèe m·∫°nh. H√£y quan t√¢m th√™m ƒë·∫øn c√°c y·∫øu t·ªë kh√°c nh∆∞ t·ª∑ l·ªá m·ª°/c∆°, s·ªë ƒëo v√≤ng eo, ch·∫•t l∆∞·ª£ng gi·∫•c ng·ªß v√† s·ª©c kh·ªèe tinh th·∫ßn. ƒê√¢y l√† giai ƒëo·∫°n v√†ng ƒë·ªÉ c·ªßng c·ªë c√°c th√≥i quen t·ªët, t·∫°o n·ªÅn t·∫£ng v·ªØng ch·∫Øc cho s·ª©c kh·ªèe l√¢u d√†i.', ctaText: 'B·∫°n mu·ªën n√¢ng cao th·ªÉ l·ª±c v√† v√≥c d√°ng h∆°n n·ªØa?', ctaButton: 'Kh√°m ph√° c√°c d·ªãch v·ª•', ctaLinkHref: 'index.html' }; } else if (bmi >= 25 && bmi < 29.9) { return { text: 'Th·ª´a c√¢n', className: 'status-overweight', summary: 'B·∫°n n√™n xem x√©t vi·ªác gi·∫£m c√¢n ƒë·ªÉ c·∫£i thi·ªán s·ª©c kh·ªèe.', warning: 'C·∫¢NH B√ÅO V√ÄNG - C·∫¶N CAN THI·ªÜP. ƒê√¢y l√† "ƒë√®n v√†ng" tr√™n h√†nh tr√¨nh s·ª©c kh·ªèe c·ªßa b·∫°n. B·∫°n ch∆∞a b·ªã b√©o ph√¨, nh∆∞ng c∆° th·ªÉ ƒë√£ b·∫Øt ƒë·∫ßu t√≠ch tr·ªØ m·ª° th·ª´a ·ªü m·ª©c c√≥ th·ªÉ g√¢y h·∫°i. Nguy c∆° ph√°t tri·ªÉn c√°c b·ªánh nh∆∞ cao huy·∫øt √°p, m·ª° m√°u, kh√°ng insulin (ti·ªÅn ti·ªÉu ƒë∆∞·ªùng) v√† b·ªánh tim m·∫°ch ƒë√£ b·∫Øt ƒë·∫ßu tƒÉng l√™n.', action: `<ul><li><strong>H√ÄNH ƒê·ªòNG NGAY, ƒê·ª™NG CH·∫¶N CH·ª™:</strong> ƒê√¢y l√† th·ªùi ƒëi·ªÉm t·ªët nh·∫•t ƒë·ªÉ thay ƒë·ªïi. Vi·ªác gi·∫£m m·ªôt v√†i kg ·ªü giai ƒëo·∫°n n√†y s·∫Ω d·ªÖ d√†ng v√† hi·ªáu qu·∫£ h∆°n r·∫•t nhi·ªÅu so v·ªõi khi ƒë√£ b·ªã b√©o ph√¨.</li><li><strong>R√† so√°t l·∫°i ch·∫ø ƒë·ªô ƒÉn:</strong> Ghi l·∫°i nh·∫≠t k√Ω ƒÉn u·ªëng trong 3-5 ng√†y ƒë·ªÉ xem b·∫°n ƒëang ƒÉn g√¨. Th∆∞·ªùng th√¨ v·∫•n ƒë·ªÅ n·∫±m ·ªü ƒë·ªì ƒÉn v·∫∑t, n∆∞·ªõc ng·ªçt, ƒë·ªì ƒÉn nhanh v√† kh·∫©u ph·∫ßn ƒÉn qu√° l·ªõn.</li><li><strong>C·∫Øt gi·∫£m:</strong> ƒê∆∞·ªùng, ƒë·ªì u·ªëng c√≥ c·ªìn, th·ª±c ph·∫©m chi√™n r√°n, tinh b·ªôt tinh ch·∫ø (b√°nh m√¨ tr·∫Øng, b√∫n, ph·ªü).</li><li><strong>TƒÉng c∆∞·ªùng:</strong> Ch·∫•t x∆° t·ª´ rau c·ªß, salad, tr√°i c√¢y √≠t ng·ªçt ƒë·ªÉ b·∫°n no l√¢u h∆°n. U·ªëng ƒë·ªß n∆∞·ªõc.</li><li><strong>TƒÉng c∆∞·ªùng v·∫≠n ƒë·ªông:</strong> N·∫øu b·∫°n ch∆∞a v·∫≠n ƒë·ªông, h√£y b·∫Øt ƒë·∫ßu b·∫±ng 30 ph√∫t ƒëi b·ªô m·ªói ng√†y. N·∫øu ƒë√£ c√≥, h√£y tƒÉng d·∫ßn th·ªùi gian ho·∫∑c c∆∞·ªùng ƒë·ªô. K·∫øt h·ª£p c·∫£ cardio (ƒë·ªët m·ª°) v√† t·∫≠p kh√°ng l·ª±c (x√¢y d·ª±ng c∆° ƒë·ªÉ tƒÉng c∆∞·ªùng trao ƒë·ªïi ch·∫•t).</li><li><strong>Ki·ªÉm so√°t kh·∫©u ph·∫ßn:</strong> ƒÇn b·∫±ng b√°t/ƒëƒ©a nh·ªè h∆°n. ƒÇn ch·∫≠m, nhai k·ªπ. D·ª´ng l·∫°i khi c·∫£m th·∫•y no kho·∫£ng 80%.</li></ul>`, recommendation: 'H√£y ƒë·∫∑t m·ª•c ti√™u gi·∫£m c√¢n th·ª±c t·∫ø v√† b·ªÅn v·ªØng, kho·∫£ng 5-10% tr·ªçng l∆∞·ª£ng c∆° th·ªÉ trong 6 th√°ng. S·ª± thay ƒë·ªïi nh·ªè nh∆∞ng nh·∫•t qu√°n s·∫Ω t·∫°o ra k·∫øt qu·∫£ l·ªõn.', ctaText: 'B·∫Øt ƒë·∫ßu h√†nh tr√¨nh gi·∫£m c√¢n c·ªßa b·∫°n ngay h√¥m nay!', ctaButton: 'ƒêƒÉng k√Ω hu·∫•n luy·ªán', ctaLinkHref: 'dang-ky.html?service=hl-ca-nhan' }; } else { return { text: 'B√©o ph√¨', className: 'status-obese', summary: 'M·ª©c c√¢n n·∫∑ng c·ªßa b·∫°n c√≥ nguy c∆° cao ·∫£nh h∆∞·ªüng ƒë·∫øn s·ª©c kh·ªèe.', warning: 'B√ÅO ƒê·ªòNG ƒê·ªé - NGUY HI·ªÇM. ƒê√¢y kh√¥ng c√≤n l√† v·∫•n ƒë·ªÅ v·ªÅ ngo·∫°i h√¨nh, m√† l√† m·ªôt T√åNH TR·∫†NG B·ªÜNH L√ù c·∫ßn ƒë∆∞·ª£c can thi·ªáp y t·∫ø nghi√™m t√∫c. M·ªói c·∫•p ƒë·ªô b√©o ph√¨ tƒÉng l√™n, nguy c∆° m·∫Øc c√°c b·ªánh nguy hi·ªÉm nh∆∞ ti·ªÉu ƒë∆∞·ªùng type 2, b·ªánh tim m·∫°ch, ƒë·ªôt qu·ªµ, ng∆∞ng th·ªü khi ng·ªß, b·ªánh x∆∞∆°ng kh·ªõp v√† m·ªôt s·ªë lo·∫°i ung th∆∞ s·∫Ω tƒÉng theo c·∫•p s·ªë nh√¢n.', action: `<ul><li><strong>T√åM KI·∫æM S·ª∞ TR·ª¢ GI√öP Y T·∫æ CHUY√äN NGHI·ªÜP:</strong> B·∫°n kh√¥ng n√™n chi·∫øn ƒë·∫•u m·ªôt m√¨nh. H√£y ƒë·∫øn g·∫∑p b√°c sƒ© ƒë·ªÉ ƒë∆∞·ª£c ƒë√°nh gi√° s·ª©c kh·ªèe t·ªïng th·ªÉ, l√†m c√°c x√©t nghi·ªám c·∫ßn thi·∫øt (ƒë∆∞·ªùng huy·∫øt, m·ª° m√°u, ch·ª©c nƒÉng gan, tim m·∫°ch...). B√°c sƒ© v√† chuy√™n gia dinh d∆∞·ª°ng s·∫Ω x√¢y d·ª±ng m·ªôt ph√°c ƒë·ªì ƒëi·ªÅu tr·ªã an to√†n v√† ph√π h·ª£p cho b·∫°n.</li><li><strong>Thay ƒë·ªïi dinh d∆∞·ª°ng to√†n di·ªán:</strong> B·∫°n c·∫ßn m·ªôt k·∫ø ho·∫°ch ƒÉn u·ªëng c√≥ c·∫•u tr√∫c ch·∫∑t ch·∫Ω, ƒë∆∞·ª£c c√° nh√¢n h√≥a, t·∫°o ra s·ª± th√¢m h·ª•t calo an to√†n. ƒêi·ªÅu n√†y ƒë√≤i h·ªèi ph·∫£i lo·∫°i b·ªè g·∫ßn nh∆∞ ho√†n to√†n th·ª±c ph·∫©m c√¥ng nghi·ªáp, ƒë·ªì ng·ªçt, ch·∫•t b√©o chuy·ªÉn h√≥a v√† ki·ªÉm so√°t ch·∫∑t ch·∫Ω kh·∫©u ph·∫ßn ƒÉn.</li><li><strong>V·∫≠n ƒë·ªông c√≥ h∆∞·ªõng d·∫´n:</strong> B·∫Øt ƒë·∫ßu t·ª´ t·ª´ v·ªõi c√°c b√†i t·∫≠p c∆∞·ªùng ƒë·ªô th·∫•p v√† √≠t t√°c ƒë·ªông l√™n kh·ªõp nh∆∞ ƒëi b·ªô, b∆°i l·ªôi, ƒë·∫°p xe t·∫°i ch·ªó. Khi th·ªÉ l·ª±c c·∫£i thi·ªán, b·∫°n c√≥ th·ªÉ tƒÉng d·∫ßn c∆∞·ªùng ƒë·ªô d∆∞·ªõi s·ª± gi√°m s√°t ƒë·ªÉ tr√°nh ch·∫•n th∆∞∆°ng, ƒë·∫∑c bi·ªát l√† c√°c v·∫•n ƒë·ªÅ v·ªÅ kh·ªõp g·ªëi v√† c·ªôt s·ªëng.</li><li><strong>Can thi·ªáp t√¢m l√Ω:</strong> ƒê√¥i khi ƒÉn u·ªëng qu√° ƒë·ªô li√™n quan ƒë·∫øn c√°c v·∫•n ƒë·ªÅ t√¢m l√Ω nh∆∞ cƒÉng th·∫≥ng, tr·∫ßm c·∫£m. Vi·ªác t∆∞ v·∫•n t√¢m l√Ω c√≥ th·ªÉ gi√∫p gi·∫£i quy·∫øt g·ªëc r·ªÖ c·ªßa v·∫•n ƒë·ªÅ.</li><li><strong>C√¢n nh·∫Øc c√°c ph∆∞∆°ng ph√°p kh√°c:</strong> ƒê·ªëi v·ªõi b√©o ph√¨ ƒë·ªô II, III, n·∫øu vi·ªác thay ƒë·ªïi l·ªëi s·ªëng kh√¥ng hi·ªáu qu·∫£, b√°c sƒ© c√≥ th·ªÉ th·∫£o lu·∫≠n v·ªÅ vi·ªác s·ª≠ d·ª•ng thu·ªëc ho·∫∑c c√°c ph∆∞∆°ng ph√°p can thi·ªáp ngo·∫°i khoa.</li></ul>`, recommendation: 'H√†nh tr√¨nh tho√°t kh·ªèi b√©o ph√¨ l√† m·ªôt con ƒë∆∞·ªùng d√†i v√† ƒë·∫ßy th·ª≠ th√°ch, ƒë√≤i h·ªèi s·ª± quy·∫øt t√¢m s·∫Øt ƒë√°. H√£y t·∫≠p trung v√†o m·ª•c ti√™u c·∫£i thi·ªán s·ª©c kh·ªèe, kh√¥ng ch·ªâ l√† con s·ªë tr√™n b√†n c√¢n. M·ªói kg gi·∫£m ƒë∆∞·ª£c ƒë·ªÅu l√† m·ªôt chi·∫øn th·∫Øng l·ªõn cho tr√°i tim, m·∫°ch m√°u v√† to√†n b·ªô c∆° th·ªÉ c·ªßa b·∫°n.', ctaText: 'Nh·∫≠n s·ª± h·ªó tr·ª£ chuy√™n nghi·ªáp ƒë·ªÉ thay ƒë·ªïi cu·ªôc s·ªëng!', ctaButton: 'Li√™n h·ªá chuy√™n gia', ctaLinkHref: 'dang-ky.html' }; } }
        
        calculateBtn.addEventListener('click', () => {
            const ageInput = document.getElementById('age');
            const heightInput = document.getElementById('height');
            const weightInput = document.getElementById('weight');
            if (!ageInput.value || !heightInput.value || !weightInput.value) {
                alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin Tu·ªïi, Chi·ªÅu cao v√† C√¢n n·∫∑ng ƒë·ªÉ ph√¢n t√≠ch.');
                return;
            }
            
            const age = parseInt(ageInput.value);
            const height = parseInt(heightInput.value);
            const weight = parseFloat(weightInput.value);
            const activityValue = document.getElementById('activity').value;
            
            resultsArea.style.display = 'block';
            calculateBtn.textContent = 'Ph√¢n T√≠ch L·∫°i';
            
            setTimeout(() => { resultsArea.scrollIntoView({ behavior: 'smooth' }); }, 100);

            const bmi = (weight / ((height / 100) * (height / 100)));
            const bmiStatus = getBmiStatus(bmi);
            let bmr = 0;
            if (parseFloat(document.getElementById('bodyfat').value) > 0) { bmr = 370 + (21.6 * (weight * (1 - parseFloat(document.getElementById('bodyfat').value) / 100))); } else { if (document.querySelector('input[name="gender"]:checked').value === 'male') { bmr = (10 * weight) + (6.25 * height) - (5 * age) + 5; } else { bmr = (10 * weight) + (6.25 * height) - (5 * age) - 161; } }
            const tdee = bmr * parseFloat(activityValue);
            
            animateDecimal(document.getElementById('bmi-value'), 0, bmi, 1500);
            document.getElementById('bmi-interpretation').textContent = bmiStatus.text;
            document.getElementById('bmi-interpretation').className = bmiStatus.className;
            document.getElementById('bmi-summary-text').textContent = bmiStatus.summary;
            const bmiPercent = Math.min(100, Math.max(0, ((bmi - 15) / (35 - 15)) * 100));
            setTimeout(() => { 
                const progressEl = document.getElementById('bmi-progress-value');
                progressEl.style.width = `${bmiPercent}%`; 
                const colorVar = `--${bmiStatus.className}`;
                progressEl.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue(colorVar);
            }, 100);
            animateValue(document.getElementById('tdee-value'), 0, Math.round(tdee), 1500);
            animateValue(document.getElementById('bmr-value'), 0, Math.round(bmr), 1500);
            document.getElementById('bmi-warning').innerHTML = bmiStatus.warning;
            document.getElementById('bmi-action').innerHTML = bmiStatus.action;
            document.getElementById('bmi-recommendation').innerHTML = bmiStatus.recommendation;
            const heightInMeters = height / 100;
            document.getElementById('min-weight').textContent = (18.5 * (heightInMeters * heightInMeters)).toFixed(1);
            document.getElementById('max-weight').textContent = (24.9 * (heightInMeters * heightInMeters)).toFixed(1);
            
            const macroGoals = { "Gi·∫£m c√¢n (th√¢m h·ª•t ~15%)": tdee - (tdee * 0.15), "Duy tr√¨": tdee, "TƒÉng c∆° (d∆∞ th·ª´a ~15%)": tdee + (tdee * 0.15) };
            const macrosContainer = document.getElementById('macros-results-container');
            macrosContainer.innerHTML = '';
            for (const goal in macroGoals) {
                const calories = macroGoals[goal];
                const protein = Math.round(weight * 2);
                const fat = Math.round((calories * 0.25) / 9);
                const carbs = Math.round((calories - (protein * 4) - (fat * 9)) / 4);
                const cardHTML = `
                    <div class="macro-card">
                        <h4>${goal}</h4>
                        <div class="macro-calories">${Math.round(calories).toLocaleString('vi-VN')} <span>calo</span></div>
                        <div class="macro-details-grid">
                            <div class="macro-detail-item"><strong>${protein}</strong>g Protein</div>
                            <div class="macro-detail-item"><strong>${carbs}</strong>g Carb</div>
                            <div class="macro-detail-item"><strong>${fat}</strong>g Fat</div>
                        </div>
                    </div>`;
                macrosContainer.innerHTML += cardHTML;
            }
            document.getElementById('cta-text').textContent = bmiStatus.ctaText;
            document.getElementById('cta-link').textContent = bmiStatus.ctaButton;
            document.getElementById('cta-link').href = bmiStatus.ctaLinkHref;

            const restingHR = parseInt(document.getElementById('hr-resting').value);
            const hrAnalysisCard = document.getElementById('hr-analysis-card');
            if (age) {
                const maxHR = 208 - (0.7 * age); 
                const hrAccordionContainer = document.getElementById('hr-accordion-container');
                hrAccordionContainer.innerHTML = '';

                const hrMaxData = { name: 'Nh·ªãp tim t·ªëi ƒëa (HRmax)', content: `Nh·ªãp tim t·ªëi ƒëa (HRmax) l√† s·ªë nh·ªãp ƒë·∫≠p cao nh·∫•t m√† tim b·∫°n c√≥ th·ªÉ ƒë·∫°t ƒë∆∞·ª£c trong m·ªôt ph√∫t khi g·∫Øng s·ª©c... ∆Ø·ªõc t√≠nh HRmax c·ªßa b·∫°n l√† <strong>${Math.round(maxHR)} bpm</strong> (c√¥ng th·ª©c Tanaka).<br><strong>L·ªùi khuy√™n:</strong> ƒê·ª´ng √°m ·∫£nh b·ªüi c√¥ng th·ª©c, h√£y d√πng n√≥ l√†m ƒëi·ªÉm kh·ªüi ƒë·∫ßu v√† ƒëi·ªÅu ch·ªânh d·ª±a tr√™n c·∫£m nh·∫≠n th·ª±c t·∫ø.` };
                const zonesData = [
                    { name: 'V√πng 1: Ph·ª•c h·ªìi', range: [0.5, 0.6], color: '#a0e1f6', content: "·ªû v√πng n√†y, c∆° th·ªÉ s·ª≠ d·ª•ng nƒÉng l∆∞·ª£ng t·ª´ ch·∫•t b√©o, k√≠ch th√≠ch l∆∞u th√¥ng m√°u gi√∫p c∆° b·∫Øp ph·ª•c h·ªìi nhanh h∆°n. H√£y s·ª≠ d·ª•ng cho c√°c b√†i kh·ªüi ƒë·ªông, th·∫£ l·ªèng v√† trong c√°c ng√†y ph·ª•c h·ªìi." },
                    { name: 'V√πng 2: ƒê·ªët m·ª° & N·ªÅn t·∫£ng', range: [0.6, 0.7], color: '#7cebcf', content: "V√πng quan tr·ªçng nh·∫•t ƒë·ªÉ x√¢y d·ª±ng s·ª©c b·ªÅn, n∆°i c∆° th·ªÉ h·ªçc c√°ch s·ª≠ d·ª•ng ch·∫•t b√©o l√†m nhi√™n li·ªáu ch√≠nh. C√°c b√†i t·∫≠p d√†i (long run, long ride) n√™n ƒë∆∞·ª£c th·ª±c hi·ªán ·ªü ƒë√¢y." },
                    { name: 'V√πng 3: Aerobic (Tempo)', range: [0.7, 0.8], color: '#f7d685', content: "C·∫£i thi·ªán hi·ªáu qu·∫£ h·ªá tim m·∫°ch, gi√∫p duy tr√¨ t·ªëc ƒë·ªô \"kh√° nhanh\" trong th·ªùi gian d√†i. C·∫©n th·∫≠n kh√¥ng t·∫≠p qu√° nhi·ªÅu ·ªü \"v√πng x√°m\" n√†y v√¨ n√≥ g√¢y cƒÉng th·∫≥ng ƒë√°ng k·ªÉ." },
                    { name: 'V√πng 4: Ng∆∞·ª°ng Anaerobic', range: [0.8, 0.9], color: '#f5b072', content: "V√πng c∆∞·ªùng ƒë·ªô cao gi√∫p n√¢ng cao ng∆∞·ª°ng lactate (LT), y·∫øu t·ªë quy·∫øt ƒë·ªãnh th√†nh t√≠ch s·ª©c b·ªÅn. N√™n t·∫≠p d∆∞·ªõi d·∫°ng c√°c b√†i bi·∫øn t·ªëc (intervals) v√† kh√¥ng qu√° 1-2 l·∫ßn/tu·∫ßn." },
                    { name: 'V√πng 5: T·ªëi ƒëa (VO2 Max)', range: [0.9, 1.0], color: '#f28b82', content: "N·ªó l·ª±c g·∫Øng s·ª©c to√†n di·ªán gi√∫p ph√°t tri·ªÉn s·ª©c m·∫°nh v√† t·ªëc ƒë·ªô t·ªëi ƒëa, c·∫£i thi·ªán VO2 max. Ch·ªâ d√†nh cho ng∆∞·ªùi c√≥ n·ªÅn t·∫£ng th·ªÉ l·ª±c t·ªët, th·ª±c hi·ªán d∆∞·ªõi d·∫°ng HIIT ng·∫Øn." }
                ];
                
                let accordionHTML = `<div class="accordion-item"><button class="accordion-header"><div class="zone-title">${hrMaxData.name}</div><span class="accordion-icon">+</span></button><div class="accordion-content"><div class="content-inner"><p>${hrMaxData.content}</p></div></div></div>`;
                
                zonesData.forEach(zone => {
                    let lower, upper;
                    if (restingHR) { lower = Math.round(((maxHR - restingHR) * zone.range[0]) + restingHR); upper = Math.round(((maxHR - restingHR) * zone.range[1]) + restingHR); } else { lower = Math.round(maxHR * zone.range[0]); upper = Math.round(maxHR * zone.range[1]); }
                    accordionHTML += `<div class="accordion-item"><button class="accordion-header"><div class="zone-title"><span class="zone-color" style="background-color: ${zone.color};"></span>${zone.name}</div><small style="margin-left: auto; margin-right: 15px; font-weight: 600; color: var(--primary-color);">${lower} - ${upper} bpm</small><span class="accordion-icon">+</span></button><div class="accordion-content"><div class="content-inner"><p>${zone.content}</p></div></div></div>`;
                });
                hrAccordionContainer.innerHTML = accordionHTML;

                hrAnalysisCard.style.display = 'block';
                
                document.querySelectorAll('.accordion-header').forEach(button => {
                    button.addEventListener('click', () => {
                        const content = button.nextElementSibling;
                        button.classList.toggle('active');
                        if (content.style.maxHeight) {
                            content.style.maxHeight = null;
                        } else {
                            content.style.maxHeight = content.scrollHeight + "px";
                        }
                    });
                });
            } else {
                hrAnalysisCard.style.display = 'none';
            }
        });
        
        const modal = document.getElementById('qr-modal');
        const donateButton = document.getElementById('donate-button');
        const closeButton = document.querySelector('.close-button');
        donateButton.onclick = function() { modal.style.display = "block"; }
        closeButton.onclick = function() { modal.style.display = "none"; }
        window.onclick = function(event) { if (event.target == modal) { modal.style.display = "none"; } }

        const shareButton = document.getElementById('share-link');
        shareButton.addEventListener('click', (e) => {
            e.preventDefault();
            const originalText = shareButton.innerHTML;
            const pageUrl = window.location.href;
            navigator.clipboard.writeText(pageUrl).then(() => {
                shareButton.innerHTML = '‚úÖ ƒê√£ sao ch√©p!';
                setTimeout(() => {
                    shareButton.innerHTML = originalText;
                }, 2000);
            }).catch(err => {
                console.error('Kh√¥ng th·ªÉ sao ch√©p link: ', err);
                alert('Sao ch√©p link th·∫•t b·∫°i!');
            });
        });
    </script>
</body>
</html>
