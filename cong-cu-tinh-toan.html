<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C√¥ng C·ª• Ph√¢n T√≠ch S·ª©c Kh·ªèe - 9isBalance</title>
    <link rel="icon" type="image/png" href="https://i.postimg.cc/59qtkKWY/AVA-BETA.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #007BFF;
            --secondary-color: #00C6FF;
            --dark-color: #2c3e50;
            --light-color: #ffffff;
            --text-color: #4a4a4a;
            --gray-bg: #f0f4f8;
            --border-radius: 20px;
            --shadow: 0 15px 35px rgba(60, 90, 130, 0.1);
            --status-underweight: #3498db;
            --status-normal: #28a745;
            --status-overweight: #f1c40f;
            --status-obese: #e74c3c;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Be Vietnam Pro', sans-serif;
            background-color: var(--gray-bg);
            color: var(--text-color);
            line-height: 1.6;
            padding: 10px;
        }
        .wrapper { max-width: 1200px; margin: 0 auto; }
        
        .main-header { display: flex; justify-content: space-between; align-items: center; padding: 10px 20px 30px 20px; }
        .logo { font-size: 1.8em; font-weight: 800; color: var(--dark-color); text-decoration: none; }
        
        .main-nav { display: flex; align-items: center; }
        .main-nav a, .dropdown-btn { text-decoration: none; color: var(--dark-color); margin-left: 25px; font-weight: 600; padding: 8px 12px; border-radius: 8px; transition: all 0.3s ease; cursor: pointer; }
        .main-nav a:hover, .dropdown-btn:hover { color: var(--primary-color); }
        .main-nav a.active, .dropdown-btn.active { background-image: linear-gradient(45deg, var(--primary-color), var(--secondary-color)); color: var(--light-color); }
        
        .dropdown { position: relative; display: inline-block; }
        .dropdown-content { display: none; position: absolute; background-color: var(--light-color); min-width: 220px; box-shadow: 0 8px 16px 0 rgba(0,0,0,0.1); z-index: 1; border-radius: var(--border-radius); margin-top: 10px; padding: 5px 0; border: 1px solid #eee; }
        .dropdown-content a { color: var(--dark-color); padding: 12px 16px; text-decoration: none; display: block; margin-left: 0; border-radius: 0; font-size: 0.95em; }
        .dropdown-content a:hover { background-color: #f1f1f1; }
        .dropdown:hover .dropdown-content { display: block; }
        
        .app-grid { display: grid; grid-template-columns: 380px 1fr; gap: 30px; align-items: flex-start; }
        .card { background: var(--light-color); border-radius: var(--border-radius); box-shadow: var(--shadow); padding: 30px; }
        
        .calculator-form h1 { font-size: 1.8em; font-weight: 800; color: var(--dark-color); margin-bottom: 25px; }
        .form-group { margin-bottom: 18px; }
        .form-group label { font-weight: 700; color: var(--dark-color); display: flex; align-items: center; margin-bottom: 10px; }
        .form-group label span { margin-right: 8px; font-size: 1.2em; color: var(--primary-color); }
        
        .input-text, .input-select { width: 100%; padding: 12px 15px; border-radius: 10px; border: 1px solid #dfe6e9; font-family: 'Be Vietnam Pro', sans-serif; font-size: 1em; transition: all 0.3s ease; }
        .input-text:focus, .input-select:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.15); }
        .input-radio-group { display: flex; gap: 20px; }
        
        .btn { padding: 14px 30px; border: none; border-radius: 50px; font-size: 1.1em; font-weight: 700; cursor: pointer; transition: all 0.3s ease; width: 100%; background-image: linear-gradient(45deg, var(--primary-color), var(--secondary-color)); color: var(--light-color); box-shadow: 0 8px 20px rgba(0, 123, 255, 0.3); margin-top: 10px; }
        .btn:hover { transform: translateY(-3px); box-shadow: 0 10px 25px rgba(0, 123, 255, 0.4); }
        .btn:disabled { background-image: none; background-color: #bdc3c7; cursor: not-allowed; box-shadow: none; transform: none; }

        .results-container { display: none; grid-template-columns: 1fr 1fr; gap: 25px; }
        .results-container.visible { display: grid; }
        .result-card { background: var(--light-color); border-radius: var(--border-radius); box-shadow: var(--shadow); padding: 25px; animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        .result-card h3 { font-size: 1.1em; font-weight: 700; color: var(--dark-color); margin-bottom: 15px; text-align: center; }
        
        .bmi-card-content { text-align: center; }
        .bmi-main-result { display: flex; justify-content: center; align-items: baseline; margin-bottom: 15px; }
        #bmi-value { font-size: 4em; font-weight: 800; line-height: 1; }
        #bmi-interpretation { font-weight: 700; font-size: 1.5em; margin-left: 10px; }
        .bmi-progress-bar { height: 10px; background-color: #eef5f9; border-radius: 10px; overflow: hidden; position: relative; }
        #bmi-progress-value { height: 100%; width: 0; border-radius: 10px; transition: width 1.5s ease-out, background-color 0.5s ease; }
        .bmi-summary { font-size: 0.9em; margin-top: 10px; }
        
        .calories-card { background: rgba(44, 62, 80, 0.8); backdrop-filter: blur(10px); color: var(--light-color); display: flex; flex-direction: column; justify-content: center; }
        .tdee-main { text-align: center; margin-bottom: 20px; }
        .tdee-main .icon { font-size: 2em; line-height: 1; opacity: 0.8; }
        .tdee-main .value { font-size: 3.5em; font-weight: 800; color: var(--light-color); line-height: 1.1; }
        .tdee-main .label { font-size: 0.9em; opacity: 0.8; font-weight: 600; }
        .bmr-secondary { text-align: center; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 15px; }
        .bmr-secondary .value { font-size: 1.8em; font-weight: 700; }
        .bmr-secondary .label { font-size: 0.9em; opacity: 0.7; }

        .advice-card, .macros-card, .cta-card { grid-column: 1 / -1; }
        .detail-item { margin-bottom: 15px; }
        .detail-item p { font-size: 0.9em; opacity: 0.9; }
        .detail-item-title { font-size: 1em; font-weight: 700; margin-bottom: 5px; display: flex; align-items: center; }
        .detail-item-title span { margin-right: 8px; }
        .tdee-macro-table { width: 100%; border-collapse: collapse; text-align: center; }
        .tdee-macro-table th, .tdee-macro-table td { padding: 12px; border-bottom: 1px solid var(--gray-bg); }
        .tdee-macro-table th { font-weight: 700; font-size: 0.9em; }
        .tdee-macro-table tr:last-child td { border: none; }
        .tdee-macro-table .goal-col { font-weight: 600; }
        
        .cta-card { background-image: linear-gradient(45deg, var(--primary-color), var(--secondary-color)); color: var(--light-color); text-align: center; }
        .cta-card p { margin-bottom: 15px; font-size: 1.1em; }
        .cta-btn { text-decoration: none; color: var(--primary-color); background: var(--light-color); padding: 10px 25px; border-radius: 50px; font-weight: 700; transition: all 0.3s ease; }
        .cta-btn:hover { transform: scale(1.05); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        
        .hidden { display: none; }
        
        @media (max-width: 900px) {
            .app-grid, .results-container { grid-template-columns: 1fr; }
            .advice-card, .macros-card, .cta-card { grid-column: auto; }
            .main-header { flex-direction: column; gap: 15px; }
            .main-nav { flex-direction: column; width: 100%; gap: 10px; }
            .main-nav a, .dropdown { margin-left: 0; width: 100%; text-align: center; }
            .main-nav a.active { background-color: var(--primary-color); }
            .dropdown-content { display: none; position: static; box-shadow: none; border: none; background-color: var(--gray-bg); width: 100%; padding-top: 10px; }
            .dropdown:hover .dropdown-content, .dropdown-btn:focus + .dropdown-content { display: flex; flex-direction: column; gap: 5px; }
            .dropdown-content a { background-color: var(--light-color); border-radius: 8px; }
            .card { padding: 20px; }
            .calculator-form h1 { font-size: 1.6em; }
        }
    </style>
</head>
<body>
    <div class="wrapper">
        <header class="main-header">
            <a href="index.html" class="logo">9isBalance</a>
            <nav class="main-nav">
                <div class="dropdown">
                    <span class="dropdown-btn">D·ªãch v·ª• ‚ñº</span>
                    <div class="dropdown-content">
                        <a href="index.html">HL C√° nh√¢n</a>
                        <a href="huan-luyen-nang-cao.html">HL N√¢ng cao</a>
                        <a href="tri-lieu-phuc-hoi.html">Tr·ªã li·ªáu & Ph·ª•c h·ªìi</a>
                        <a href="tu-van-online.html">T∆∞ v·∫•n Online</a>
                    </div>
                </div>
                <a href="cong-cu-tinh-toan.html" class="active">C√¥ng c·ª• S·ª©c kh·ªèe</a>
                <a href="gioi-thieu.html">V·ªÅ t√¥i</a>
                <a href="dang-ky.html">ƒêƒÉng k√Ω</a>
            </nav>
        </header>

        <div class="app-grid">
            <div class="card calculator-form">
                <h1>Ph√¢n T√≠ch S·ª©c Kh·ªèe To√†n Di·ªán</h1>
                <div class="form-group"><label for="gender"><span>üë§</span>Gi·ªõi t√≠nh</label><div class="input-radio-group"><label><input type="radio" name="gender" value="male" checked> Nam</label><label><input type="radio" name="gender" value="female"> N·ªØ</label></div></div>
                <div class="form-group"><label for="age"><span>üéÇ</span>Tu·ªïi</label><input type="number" id="age" class="input-text" placeholder="Nh·∫≠p tu·ªïi c·ªßa b·∫°n" min="15" max="100"></div>
                <div class="form-group"><label for="height"><span>üìè</span>Chi·ªÅu cao (cm)</label><input type="number" id="height" class="input-text" placeholder="V√≠ d·ª•: 175" min="100" max="220"></div>
                <div class="form-group"><label for="weight"><span>‚öñÔ∏è</span>C√¢n n·∫∑ng (kg)</label><input type="number" id="weight" class="input-text" placeholder="V√≠ d·ª•: 68.5" min="30" max="180"></div>
                <div class="form-group"><label for="bodyfat"><span>üî•</span>T·ª∑ l·ªá m·ª° (%) (T√πy ch·ªçn)</label><input type="number" id="bodyfat" class="input-text" placeholder="ƒê·ªÉ tr·ªëng n·∫øu kh√¥ng bi·∫øt" min="3" max="50"></div>
                <div class="form-group">
                    <label for="activity"><span>üèÉ</span>M·ª©c ƒë·ªô v·∫≠n ƒë·ªông</label>
                    <select id="activity" class="input-select">
                        <option value="1.2">√çt v·∫≠n ƒë·ªông (l√†m vi·ªác vƒÉn ph√≤ng)</option>
                        <option value="1.375" selected>V·∫≠n ƒë·ªông nh·∫π (t·∫≠p 1-3 ng√†y/tu·∫ßn)</option>
                        <option value="1.55">V·∫≠n ƒë·ªông v·ª´a (t·∫≠p 3-5 ng√†y/tu·∫ßn)</option>
                        <option value="1.725">V·∫≠n ƒë·ªông nhi·ªÅu (t·∫≠p 6-7 ng√†y/tu·∫ßn)</option>
                        <option value="1.9">V·∫≠n ƒë·ªông r·∫•t nhi·ªÅu (c∆∞·ªùng ƒë·ªô cao & c√¥ng vi·ªác th·ªÉ ch·∫•t)</option>
                    </select>
                </div>
                <button id="calculate-btn" class="btn">Ph√¢n T√≠ch Ngay</button>
            </div>
            
            <div class="right-panel">
                <div class="card welcome-panel" id="welcome-panel">
                    <div class="icon" style="font-size: 3.5em; line-height: 1; margin-bottom: 15px; background: -webkit-linear-gradient(45deg, var(--primary-color), var(--secondary-color)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">üí°</div>
                    <h2 style="font-size: 1.5em; font-weight: 700; color: var(--dark-color); margin-bottom: 10px;">B·∫Øt ƒë·∫ßu H√†nh tr√¨nh S·ª©c kh·ªèe</h2>
                    <p style="margin-bottom: 20px;">Nh·∫≠p c√°c th√¥ng s·ªë c·ªßa b·∫°n ƒë·ªÉ nh·∫≠n m·ªôt b·∫£n ph√¢n t√≠ch to√†n di·ªán v√† nh·ªØng l·ªùi khuy√™n ƒë∆∞·ª£c c√° nh√¢n h√≥a, gi√∫p b·∫°n hi·ªÉu r√µ h∆°n v·ªÅ c∆° th·ªÉ m√¨nh.</p>
                    <h3 style="font-size: 1.1em; font-weight: 700; color: var(--dark-color); margin-bottom: 10px;">B·∫°n s·∫Ω nh·∫≠n ƒë∆∞·ª£c:</h3>
                    <ul style="list-style: none; padding-left: 0; text-align: left;">
                        <li style="margin-bottom: 10px; font-weight: 600; display: flex; align-items: center;"><span style="color: var(--primary-color); font-weight: 800; margin-right: 10px;">‚úì</span>Ch·ªâ s·ªë BMI & T√¨nh tr·∫°ng c∆° th·ªÉ</li>
                        <li style="margin-bottom: 10px; font-weight: 600; display: flex; align-items: center;"><span style="color: var(--primary-color); font-weight: 800; margin-right: 10px;">‚úì</span>NƒÉng l∆∞·ª£ng ti√™u th·ª• h√†ng ng√†y (TDEE)</li>
                        <li style="margin-bottom: 10px; font-weight: 600; display: flex; align-items: center;"><span style="color: var(--primary-color); font-weight: 800; margin-right: 10px;">‚úì</span>L·ªùi khuy√™n chi ti·∫øt t·ª´ chuy√™n gia</li>
                        <li style="margin-bottom: 10px; font-weight: 600; display: flex; align-items: center;"><span style="color: var(--primary-color); font-weight: 800; margin-right: 10px;">‚úì</span>G·ª£i √Ω Macros cho t·ª´ng m·ª•c ti√™u</li>
                    </ul>
                </div>

                <div class="results-container" id="results-container">
                    <div class="result-card bmi-card-content">
                        <h3>Ch·ªâ s·ªë BMI</h3>
                        <div class="bmi-main-result">
                            <span id="bmi-value">--</span>
                            <span id="bmi-interpretation"></span>
                        </div>
                        <div class="bmi-progress-bar">
                            <div id="bmi-progress-value"></div>
                        </div>
                        <p class="bmi-summary" id="bmi-summary-text"></p>
                    </div>
                    <div class="result-card calories-card">
                        <div class="tdee-main"><div class="icon">üî•</div><div class="value" id="tdee-value">--</div><div class="label">TDEE (NƒÉng l∆∞·ª£ng Duy tr√¨)</div></div>
                        <div class="bmr-secondary"><div class="label">‚ù§Ô∏è NƒÉng l∆∞·ª£ng C∆° b·∫£n (BMR)</div><div class="value" id="bmr-value">--</div></div>
                    </div>
                    <div class="result-card advice-card">
                        <h3>L·ªùi khuy√™n cho b·∫°n</h3>
                        <div class="detail-item"><h4 class="detail-item-title"><span style="color: var(--status-obese);">üö®</span>M·ª©c ƒë·ªô c·∫£nh b√°o</h4><p id="bmi-warning"></p></div>
                        <div class="detail-item"><h4 class="detail-item-title"><span style="color: var(--status-normal);">üí™</span>H√†nh ƒë·ªông</h4><p id="bmi-action"></p></div>
                        <div class="detail-item"><h4 class="detail-item-title"><span style="color: var(--primary-color);">ü•ó</span>Khuy·∫øn ngh·ªã</h4><p id="bmi-recommendation"></p></div>
                    </div>
                    <div class="result-card macros-card">
                        <h3>B·∫£ng Macros G·ª£i √Ω</h3>
                        <table class="tdee-macro-table">
                            <thead><tr><th>M·ª•c ti√™u</th><th>Calo</th><th>Protein (g)</th><th>Carbs (g)</th><th>Fat (g)</th></tr></thead>
                            <tbody id="macro-results-body"></tbody>
                        </table>
                    </div>
                    <div class="result-card cta-card" id="cta-card">
                        <p id="cta-text"></p>
                        <a href="dang-ky.html" id="cta-link" class="cta-btn"></a>
                    </div>
                </div>
            </div>
        </div>
        <p style="text-align: center; margin-top: 20px; font-size: 0.9em; color: #7f8c8d;">L∆∞u √Ω: C√°c k·∫øt qu·∫£ t√≠nh to√°n ch·ªâ mang t√≠nh ch·∫•t tham kh·∫£o. H√£y li√™n h·ªá chuy√™n gia ƒë·ªÉ c√≥ l·ªùi khuy√™n ch√≠nh x√°c nh·∫•t.</p>
    </div>
    
    <script>
        const calculateBtn = document.getElementById('calculate-btn');
        const welcomePanel = document.getElementById('welcome-panel');
        const resultsContainer = document.getElementById('results-container');

        // ========= B·ªî SUNG C√ÅC H√ÄM B·ªä THI·∫æU =========
        function animateValue(element, start, end, duration) {
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                element.textContent = Math.floor(progress * (end - start) + start).toLocaleString('vi-VN');
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }

        function animateDecimal(element, start, end, duration) {
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                element.textContent = (progress * (end - start) + start).toFixed(1);
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }

        function getBmiStatus(bmi) {
            if (bmi < 18.5) {
                return {
                    text: 'Thi·∫øu c√¢n',
                    className: 'status-underweight',
                    summary: 'B·∫°n c√≥ th·ªÉ c·∫ßn tƒÉng c√¢n ƒë·ªÉ ƒë·∫°t m·ª©c kh·ªèe m·∫°nh.',
                    warning: 'T√¨nh tr·∫°ng thi·∫øu c√¢n c√≥ th·ªÉ d·∫´n ƒë·∫øn h·ªá mi·ªÖn d·ªãch y·∫øu, m·ªát m·ªèi v√† thi·∫øu h·ª•t dinh d∆∞·ª°ng.',
                    action: 'T·∫≠p trung v√†o vi·ªác x√¢y d·ª±ng c∆° b·∫Øp v√† tƒÉng c∆∞·ªùng dinh d∆∞·ª°ng. C√°c b√†i t·∫≠p kh√°ng l·ª±c s·∫Ω r·∫•t hi·ªáu qu·∫£.',
                    recommendation: 'TƒÉng l∆∞·ª£ng calo n·∫°p v√†o v·ªõi c√°c th·ª±c ph·∫©m gi√†u dinh d∆∞·ª°ng nh∆∞ protein, carb ph·ª©c h·ª£p v√† ch·∫•t b√©o l√†nh m·∫°nh. Chia nh·ªè b·ªØa ƒÉn trong ng√†y.',
                    ctaText: 'C·∫ßn m·ªôt l·ªô tr√¨nh tƒÉng c√¢n an to√†n v√† hi·ªáu qu·∫£?',
                    ctaButton: 'T∆∞ v·∫•n ngay',
                    ctaLinkHref: 'dang-ky.html?service=hl-ca-nhan'
                };
            } else if (bmi >= 18.5 && bmi < 24.9) {
                return {
                    text: 'B√¨nh th∆∞·ªùng',
                    className: 'status-normal',
                    summary: 'Ch√∫c m·ª´ng! B·∫°n ƒëang ·ªü m·ª©c c√¢n n·∫∑ng l√Ω t∆∞·ªüng.',
                    warning: 'Kh√¥ng c√≥ c·∫£nh b√°o n√†o. H√£y ti·∫øp t·ª•c duy tr√¨ l·ªëi s·ªëng l√†nh m·∫°nh n√†y.',
                    action: 'Duy tr√¨ th√≥i quen t·∫≠p luy·ªán ƒë·ªÅu ƒë·∫∑n v√† ch·∫ø ƒë·ªô ƒÉn u·ªëng c√¢n b·∫±ng ƒë·ªÉ gi·ªØ v·ªØng phong ƒë·ªô.',
                    recommendation: 'K·∫øt h·ª£p ƒëa d·∫°ng c√°c lo·∫°i h√¨nh t·∫≠p luy·ªán (cardio, kh√°ng l·ª±c, d·∫ªo dai) v√† ƒÉn ƒë·ªß c√°c nh√≥m ch·∫•t.',
                    ctaText: 'B·∫°n mu·ªën n√¢ng cao th·ªÉ l·ª±c v√† v√≥c d√°ng h∆°n n·ªØa?',
                    ctaButton: 'Kh√°m ph√° c√°c d·ªãch v·ª•',
                    ctaLinkHref: 'index.html'
                };
            } else if (bmi >= 25 && bmi < 29.9) {
                return {
                    text: 'Th·ª´a c√¢n',
                    className: 'status-overweight',
                    summary: 'B·∫°n n√™n xem x√©t vi·ªác gi·∫£m c√¢n ƒë·ªÉ c·∫£i thi·ªán s·ª©c kh·ªèe.',
                    warning: 'Th·ª´a c√¢n l√†m tƒÉng nguy c∆° m·∫Øc c√°c b·ªánh v·ªÅ tim m·∫°ch, ti·ªÉu ƒë∆∞·ªùng type 2 v√† c√°c v·∫•n ƒë·ªÅ v·ªÅ x∆∞∆°ng kh·ªõp.',
                    action: 'B·∫Øt ƒë·∫ßu b·∫±ng vi·ªác ki·ªÉm so√°t l∆∞·ª£ng calo n·∫°p v√†o v√† tƒÉng c∆∞·ªùng ho·∫°t ƒë·ªông th·ªÉ ch·∫•t. Cardio k·∫øt h·ª£p t·∫≠p kh√°ng l·ª±c l√† l·ª±a ch·ªçn t·ªëi ∆∞u.',
                    recommendation: '∆Øu ti√™n th·ª±c ph·∫©m nguy√™n ch·∫•t, gi√†u ch·∫•t x∆°, gi·∫£m ƒë∆∞·ªùng v√† ch·∫•t b√©o b√£o h√≤a. U·ªëng ƒë·ªß n∆∞·ªõc v√† ng·ªß ƒë·ªß gi·∫•c.',
                    ctaText: 'B·∫Øt ƒë·∫ßu h√†nh tr√¨nh gi·∫£m c√¢n c·ªßa b·∫°n ngay h√¥m nay!',
                    ctaButton: 'ƒêƒÉng k√Ω hu·∫•n luy·ªán',
                    ctaLinkHref: 'dang-ky.html?service=hl-ca-nhan'
                };
            } else {
                return {
                    text: 'B√©o ph√¨',
                    className: 'status-obese',
                    summary: 'M·ª©c c√¢n n·∫∑ng c·ªßa b·∫°n c√≥ nguy c∆° cao ·∫£nh h∆∞·ªüng ƒë·∫øn s·ª©c kh·ªèe.',
                    warning: 'B√©o ph√¨ l√† y·∫øu t·ªë nguy c∆° cao ƒë·ªëi v·ªõi nhi·ªÅu b·ªánh m√£n t√≠nh nguy hi·ªÉm. C·∫ßn c√≥ k·∫ø ho·∫°ch can thi·ªáp s·ªõm.',
                    action: 'C·∫ßn c√≥ m·ªôt k·∫ø ho·∫°ch gi·∫£m c√¢n r√µ r√†ng v√† b·ªÅn v·ªØng d∆∞·ªõi s·ª± gi√°m s√°t. T·∫≠p trung v√†o vi·ªác thay ƒë·ªïi l·ªëi s·ªëng to√†n di·ªán.',
                    recommendation: 'H√£y tham kh·∫£o √Ω ki·∫øn chuy√™n gia ƒë·ªÉ c√≥ m·ªôt ch·∫ø ƒë·ªô ƒÉn u·ªëng v√† t·∫≠p luy·ªán an to√†n, ph√π h·ª£p v·ªõi th·ªÉ tr·∫°ng.',
                    ctaText: 'Nh·∫≠n s·ª± h·ªó tr·ª£ chuy√™n nghi·ªáp ƒë·ªÉ thay ƒë·ªïi cu·ªôc s·ªëng!',
                    ctaButton: 'Li√™n h·ªá chuy√™n gia',
                    ctaLinkHref: 'dang-ky.html'
                };
            }
        }
        // =================================================

        calculateBtn.addEventListener('click', () => {
            const ageInput = document.getElementById('age');
            const heightInput = document.getElementById('height');
            const weightInput = document.getElementById('weight');

            // Ki·ªÉm tra c√°c tr∆∞·ªùng b·∫Øt bu·ªôc
            if (!ageInput.value || !heightInput.value || !weightInput.value) {
                alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin Tu·ªïi, Chi·ªÅu cao v√† C√¢n n·∫∑ng.');
                return;
            }

            calculateBtn.disabled = true;
            calculateBtn.textContent = 'ƒêang t√≠nh to√°n...';

            // Hi·ªÉn th·ªã k·∫øt qu·∫£ sau m·ªôt kho·∫£ng tr·ªÖ nh·ªè ƒë·ªÉ t·∫°o hi·ªáu ·ª©ng
            setTimeout(() => {
                welcomePanel.style.display = 'none';
                resultsContainer.classList.add('visible');

                const age = parseInt(ageInput.value);
                const gender = document.querySelector('input[name="gender"]:checked').value;
                const height = parseInt(heightInput.value);
                const weight = parseFloat(weightInput.value);
                const activityMultiplier = parseFloat(document.getElementById('activity').value);
                const bodyFat = parseFloat(document.getElementById('bodyfat').value);

                // --- T√≠nh to√°n BMI ---
                const bmi = (weight / ((height / 100) * (height / 100)));
                const bmiStatus = getBmiStatus(bmi);
                
                // --- T√≠nh to√°n BMR & TDEE ---
                let bmr = 0;
                if (bodyFat && bodyFat > 0) {
                    // C√¥ng th·ª©c Katch-McArdle (n·∫øu c√≥ body fat)
                    bmr = 370 + (21.6 * (weight * (1 - bodyFat / 100)));
                } else {
                    // C√¥ng th·ª©c Mifflin-St Jeor (ph·ªï bi·∫øn v√† ch√≠nh x√°c h∆°n)
                    if (gender === 'male') {
                        bmr = (10 * weight) + (6.25 * height) - (5 * age) + 5;
                    } else {
                        bmr = (10 * weight) + (6.25 * height) - (5 * age) - 161;
                    }
                }
                const tdee = bmr * activityMultiplier;
                
                // --- C·∫≠p nh·∫≠t giao di·ªán ---

                // 1. BMI Card
                const bmiValueEl = document.getElementById('bmi-value');
                const bmiInterpretationEl = document.getElementById('bmi-interpretation');
                const bmiProgressValue = document.getElementById('bmi-progress-value');
                
                animateDecimal(bmiValueEl, 0, bmi, 1500);
                bmiInterpretationEl.textContent = bmiStatus.text;
                bmiInterpretationEl.className = bmiStatus.className;
                document.getElementById('bmi-summary-text').textContent = bmiStatus.summary;

                const bmiPercent = Math.min(100, Math.max(0, ((bmi - 15) / (35 - 15)) * 100));
                setTimeout(() => {
                    bmiProgressValue.style.width = `${bmiPercent}%`;
                    bmiProgressValue.style.backgroundColor = `var(--${bmiStatus.className})`;
                }, 100);
                
                // 2. TDEE/BMR Card
                animateValue(document.getElementById('tdee-value'), 0, Math.round(tdee), 1500);
                animateValue(document.getElementById('bmr-value'), 0, Math.round(bmr), 1500);

                // 3. Advice Card
                document.getElementById('bmi-warning').textContent = bmiStatus.warning;
                document.getElementById('bmi-action').textContent = bmiStatus.action;
                document.getElementById('bmi-recommendation').textContent = bmiStatus.recommendation;
                
                // 4. Macros Card
                const macroGoals = {
                    "Gi·∫£m c√¢n (th√¢m h·ª•t ~15%)": tdee - (tdee * 0.15),
                    "Duy tr√¨": tdee,
                    "TƒÉng c∆° (d∆∞ th·ª´a ~15%)": tdee + (tdee * 0.15)
                };
                const macroResultsBody = document.getElementById('macro-results-body');
                macroResultsBody.innerHTML = '';
                for (const goal in macroGoals) {
                    const calories = macroGoals[goal];
                    const protein = Math.round(weight * 2); // G·ª£i √Ω 2g protein / kg c√¢n n·∫∑ng
                    const fat = Math.round((calories * 0.25) / 9); // 25% calo t·ª´ fat
                    const carbs = Math.round((calories - (protein * 4) - (fat * 9)) / 4);
                    
                    macroResultsBody.innerHTML += `
                        <tr>
                            <td class="goal-col">${goal}</td>
                            <td>${Math.round(calories).toLocaleString('vi-VN')}</td>
                            <td>${protein}</td>
                            <td>${carbs}</td>
                            <td>${fat}</td>
                        </tr>
                    `;
                }

                // 5. CTA Card
                document.getElementById('cta-text').textContent = bmiStatus.ctaText;
                document.getElementById('cta-link').textContent = bmiStatus.ctaButton;
                document.getElementById('cta-link').href = bmiStatus.ctaLinkHref;

                calculateBtn.disabled = false;
                calculateBtn.textContent = 'Ph√¢n T√≠ch L·∫°i';
            }, 500);
        });
    </script>
</body>
</html>
